# Bychok Design System — Acid Pastel Control Kit

Этот документ собирает воедино принципы и практические инструменты для дизайна всего опыта Bychok: от браузерного оверлея и попапа до пользовательских настроек и внутренних сервисов. Система создана с упором на понятность, предсказуемость и лёгкую кастомизацию, чтобы и команда, и пользователи могли осознанно управлять визуалом и поведением продукта.

## 1. Цели и принципы

1. **Контролируемость.** Каждый визуальный и поведенческий паттерн описан токенами и правилами. Всё, что видит пользователь, должно быть связано с именованными переменными и состояниями.
2. **Прозрачность.** UI-компоненты декомпозированы, у каждого есть чёткая зона ответственности, список состояний и параметров.
3. **Адаптивная дружелюбность.** Позитивная тональность и мягкие анимации поддерживают пользователя, но всегда сопровождаются явными настройками «как это отключить».
4. **Доступность.** Контраст, анимации, шрифты и звуки имеют альтернативы. Каждый элемент проверен на WCAG 2.1 AA.

## 2. Иерархия токенов

```
Design System
 ├─ Foundations
 │   ├─ Цвет (Color)
 │   ├─ Типографика (Typography)
 │   ├─ Пространство (Spacing)
 │   ├─ Тени и эффекты (Effects)
 │   └─ Радиусы (Radii)
 ├─ Темы (Themes)
 │   ├─ Light
 │   ├─ Dark
 │   └─ High-Contrast
 ├─ Компоненты (Components)
 │   ├─ Примитивы (Buttons, Inputs, Switches)
 │   ├─ Композиты (Overlay, Popup, PiP, Notifications)
 │   └─ Маскот и эмоции
 └─ Шаблоны (Patterns)
     ├─ Onboarding
     ├─ Focus Run
     ├─ Streak Management
     └─ Shop & Cosmetics
```

Все значения описываются в формате `design-tokens.json` (см. раздел 9) и экспортируются в CSS Custom Properties, JS-константы и Figma Styles.

## 3. Цветовая система

| Категория | Токен | HEX | Использование |
| --- | --- | --- | --- |
| Бренд | `--brand-primary` | `#6A5AF9` | Основные CTA, прогресс-бар.
| | `--brand-secondary` | `#2EF4D1` | Акцентные кнопки, подсветка активных фильтров.
| | `--brand-accent` | `#FF2E63` | Важные статусы (квест дня, прогрев).
| | `--brand-warm` | `#FFD166` | Награды, успех, подсказки.
| Нейтрали | `--neutral-900` → `--neutral-50` | `#0F1020` → `#F6F7FF` | Фоновые градации, текст.
| Обратная связь | `--success` | `#20C997` | Успехи, сохранённые серии.
| | `--warning` | `#FFB020` | Скорое сгорание стрика.
| | `--danger` | `#EF476F` | Ошибки, конфликт настроек.
| | `--info` | `#4EA8DE` | Обучение, подсказки.

**Градиенты:**
- `--gradient-energy`: `linear-gradient(135deg, #6A5AF9 0%, #2EF4D1 100%)`
- `--gradient-sunset`: `linear-gradient(135deg, #FF2E63 0%, #FFD166 100%)`

**Правила контраста:**
- Текст на стеклянном фоне ≥ 4.5:1 (используйте `--neutral-50` или `--neutral-900` в зависимости от темы).
- Акцентные CTA на контрастном фоне дублируются подсветкой и иконкой.

## 4. Типографика

| Стиль | Размер/Интерлиньяж | Вес | Применение |
| --- | --- | --- | --- |
| Display | 32/40 | 600 | Онбординг, ключевые сообщения.
| Title | 20/28 | 600 | Заголовки блоков.
| Body L | 18/26 | 400 | Основной текст.
| Body M | 16/24 | 400 | Описание, подсказки.
| Body S | 14/20 | 400 | Настройки, подписи.
| Caption | 12/16 | 500 | Тэги, статусы.
| Mono Timer | 24/28 | 600 | Таймер (`JetBrains Mono`).

Шрифты подключаются стеком: `"Inter", "SF Pro", "Segoe UI", system-ui`. Для кириллицы — локальные вариации.

## 5. Пространство, тени, радиусы

- **Spacing Scale:** `4, 8, 12, 16, 20, 24, 32, 40`. Базовая сетка — 8 px.
- **Радиусы:** `8` (input), `16` (карточки), `24` (попапы), `32` (маскотные контейнеры).
- **Тени:**
  - `shadow-sm`: `0 4px 12px rgba(15, 16, 32, 0.12)`
  - `shadow-md`: `0 12px 28px rgba(15, 16, 32, 0.18)`
  - `shadow-glow`: внутреннее свечение `0 0 16px rgba(106, 90, 249, 0.55)`
- **Стеклянный фон:** `backdrop-filter: blur(12px); background: rgba(15, 16, 32, 0.55); border: 1px solid rgba(110, 115, 145, 0.2);`

## 6. Темы и режимы

| Режим | Особенности | Пользовательские настройки |
| --- | --- | --- |
| **Light** | Светлые фоны (`--neutral-50/100`), стекло с 40% непрозрачностью. | Включён по умолчанию в дневное время.
| **Dark** | Глубокие нейтрали (`--neutral-800/900`), стекло с 60% непрозрачностью. | Пользователь включает вручную или синхронизирует с системой.
| **High-Contrast** | Увеличенный контраст (≥7:1), отсутствие градиентов, толстые контуры. | Настраивается в настройках доступности.
| **Low-Stimulus** | Выключены анимации, мягкие цвета, упрощённые переходы. | Включается пользователем в разделе Calm Mode.

Все темы — токены-пресеты. Пользовательские параметры (насыщенность, яркость, скорость анимаций) сохраняются в `Settings.uiPreferences`.

## 7. Компоненты

### 7.1 Примитивы

| Компонент | Варианты | Состояния | Контроль |
| --- | --- | --- | --- |
| Button | `primary`, `secondary`, `ghost`, `danger` | `default`, `hover`, `focus`, `pressed`, `disabled`, `loading` | Размер (`sm`, `md`, `lg`), иконка слева/справа, tooltip.
| Input | Текстовый, числовой, таймпикер | `default`, `focus`, `error`, `success`, `disabled` | Маска, плейсхолдер, вспомогательный текст.
| Toggle | Switch, Checkbox, Radio | `on`, `off`, `indeterminate` | Размер, подпись, hotkey.
| Slider | Range, Progress | `idle`, `active`, `disabled` | Подписи шкалы, сетка шагов.

Документация для разработчиков: `components/<component>/README.md` с примерами и JSON-схемой параметров.

### 7.2 Композиты

1. **Overlay Widget**
   - Брейкпоинты: `compact` (≤320 px), `regular` (320–400 px), `expanded` (400–480 px).
   - Слоты: Header (маскот + статус), Timer, Actions, Streak, Quest, Footer.
   - Настройка пользователем: порядок блоков, размер, автосворачивание, прозрачность (20–80%).
   - Горячие клавиши: `Ctrl/Cmd + Shift + B` — показать/скрыть, `Space` — старт/пауза.

2. **Popup (Browser Action)**
   - Структура вкладок с табами на 5 разделов.
   - У каждой вкладки — карточки, использующие те же примитивы.
   - Пользователь может закрепить две любимые вкладки вверху.

3. **PiP**
   - Минимальный UI: прогресс-бар, кнопки `Pause`, `Mute`, `Close`.
   - Настраиваемый масштаб (3 шага), позиция запоминается.

4. **Notifications**
   - Шаблоны: `reminder`, `success`, `quest`.
   - Каждый шаблон — комбинация иконки, текста до 60 символов, одной или двух кнопок.
   - Пользователь управляет каналами: браузерные пуши, звуки, вибро (мобильные версии).

### 7.3 Маскот

- Библиотека эмоций (10 Lottie). Каждой эмоции соответствуют события и триггеры.
- Пользователь настраивает интенсивность анимации: `full`, `reduced`, `off`.
- Дополнительные костюмы и аксессуары подключаются токеном `mascot.skin`.

## 8. Шаблоны взаимодействия

1. **Onboarding**
   - Шаги: приветствие → выбор сайтов → настройка цели → первый старт.
   - Каждый шаг — отдельная карточка с прогрессом и подсказками.
   - Контролируемость: можно пропустить или вернуться назад.

2. **Focus Run**
   - Таймер запускается с кнопки `Start 5-min run` или горячей клавиши.
   - Пользователь может в любой момент поставить паузу, добавить 5 минут или завершить.
   - По достижении цели — экран успеха с опцией поделиться, заморозить серию или начать новый заезд.

3. **Streak Management**
   - Уведомления заранее предупреждают об окончании серии.
   - В Popup → вкладка Sites доступны графики, ручное редактирование порога, активация фриза.

4. **Shop & Cosmetics**
   - Каталог карточками 3×N с фильтрами по редкости и типу.
   - Покупка сопровождается превью маскота, можно примерить перед покупкой.

## 9. Токены и экспорт

Поддерживается единый источник правды — `tokens/design-tokens.json` (пример структуры):

```json
{
  "global": {
    "color": {
      "brand": {
        "primary": { "value": "#6A5AF9" },
        "secondary": { "value": "#2EF4D1" }
      }
    },
    "space": {
      "scale": [4, 8, 12, 16, 20, 24, 32, 40]
    }
  },
  "component": {
    "button": {
      "padding": { "md": "12px 20px" },
      "radius": { "value": "16px" }
    }
  }
}
```

Экспорт через Style Dictionary:
- **CSS:** `:root { --brand-primary: #6A5AF9; }`
- **JS:** `export const tokens = { color: { brand: { primary: '#6A5AF9' }}};`
- **Figma Tokens:** синхронизация через API.

## 10. Кастомизация пользователем

### 10.1 Панель настроек

Раздел Settings → UI Preferences содержит:

- Темы: Light, Dark, High-Contrast, Low-Stimulus.
- Индивидуальные параметры: насыщенность (`0.5–1.5`), яркость (`0.8–1.2`), скорость анимаций (`0.5×`, `1×`, `1.5×`).
- Поведение виджета: автозапуск, сворачивание, прозрачность.
- Уведомления: звуки (3 варианта), интенсивность, Snooze.
- Маскот: активный скин, эмоции, интенсивность анимаций.

### 10.2 Preset Builder

Пользователь может сохранить комбинацию настроек как пресет `Focus Mode`, `Chill Mode` и быстро переключаться через Overlay (dropdown в хедере). Пресеты синхронизируются локально и в облако (если доступно).

### 10.3 Открытые API для интеграций

- `window.bychok.setTheme(themeId)`
- `window.bychok.updateToken(name, value)` (валидирует по whitelist).
- `window.bychok.on('themeChange', callback)`

Это позволяет power users создавать свои темы или подключать автоматизацию (например, изменение темы по времени суток).

## 11. Accessibility & Inclusivity

- **Контраст:** все тексты ≥4.5:1, иконки ≥3:1.
- **Анимации:** `prefers-reduced-motion` → отключаем параллакс, оставляем fade.
- **Навигация с клавиатуры:** фокус-индикатор 2 px `--brand-secondary`, последовательность TAB соответствует визуальному порядку.
- **Скринридеры:** ARIA-метки, живые регионы для таймера и уведомлений.
- **Языки:** ключевые тексты поддерживают локализацию через `i18n/*.json`.

## 12. Система дизайн-документации

- **Figma:** библиотека «Bychok DS» с компонентами, темами и примерами экранов.
- **Storybook:** `npm run storybook` поднимает каталог компонентов; каждая история включает контроль (Controls) для токенов.
- **Design Review Checklist:**
  1. Все элементы используют токены.
  2. Проверена адаптация для Light/Dark/High-Contrast.
  3. Настройки пользователя учтены и протестированы.
  4. Accessibility пройдена (контраст, клавиатура, скринридер).

## 13. Процесс управления изменениями

1. Создаём тикет «Design Change Request» с описанием мотивации и влияния.
2. Обновляем токены (если требуется) → синхронизируем с Figma/Storybook.
3. Проводим кросс-командный просмотр (дизайн + фронтенд + продукт).
4. Тестируем в QA (включая пользовательские пресеты).
5. Обновляем документацию (`docs/design_system.md`, stories, tokens).

## 14. Чек-лист запуска

- [ ] Токены обновлены и опубликованы.
- [ ] Пресеты тем протестированы (включая кастомные настройки пользователя).
- [ ] Анимации маскота соответствуют интенсивности.
- [ ] Уведомления согласованы с настройками тихих часов.
- [ ] Доступность подтверждена инструментами Lighthouse/axe.
- [ ] Пользовательский Preset Builder и API протестированы.

---

Эта система обеспечивает целостный и гибко управляемый UX для Bychok, сохраняя энергию бренда и уважение к разнообразным пользователям.
